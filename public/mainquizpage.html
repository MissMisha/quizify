<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Awesome Quiz Challenge</title>
    <link rel="stylesheet" href="./css/quizpage.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
    <!-- jQuery link -->
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </head>
  <body id="myWindow">
    <div class="quiz-container">
      <div class="row">
        <h1 class="title">Awesome Quiz Challenge</h1>
        <div class="d-grid gap-2 col-6 mx-auto">
          <!-- --------------spinner---------------- -->
          <div class="d-flex justify-content-center">
            <div class="spinner-border" role="status" id="spin">
              <span class="sr-only"></span>
            </div>
          </div>
          <!-- --------------------------------------- -->
        </div>
      </div>
      <br />

      <div>
        <h2 class="question-number">
          Question <span id="numb"></span> of <span id="count"></span>
        </h2>
        <p class="question-text" id="question"></p>
      </div>

      <div class="radio-group">
        <label class="radio-option">
          <input
            type="radio"
            name="answer"
            id="option1"
            name="optio"
            class="radio-input"
          />
          <span class="radio-label" id="soption1"></span>
        </label>
        <label class="radio-option">
          <input
            type="radio"
            name="answer"
            id="option2"
            name="optio"
            class="radio-input"
          />
          <span class="radio-label" id="soption2"></span>
        </label>
        <label class="radio-option">
          <input
            type="radio"
            name="answer"
            id="option3"
            name="optio"
            class="radio-input"
          />
          <span class="radio-label" id="soption3"></span>
        </label>
        <label class="radio-option">
          <input
            type="radio"
            name="answer"
            id="option4"
            name="optio"
            class="radio-input"
          />
          <span class="radio-label" id="soption4"></span>
        </label>
      </div>

      <div class="navigation">
        <button class="btn btn-outline" id="btnPrev">
          <span>Previous</span>
        </button>

        <div class="pagination">
          Question &nbsp; <span id="smlnum"></span> &nbsp;of&nbsp;
          <span id="smlcnt"></span>
        </div>

        <button class="btn btn-primary" id="btnNext">
          <span>Next</span>
          <svg class="icon" viewBox="0 0 24 24">
            <polyline points="9 18 15 12 9 6" />
          </svg>
        </button>
      </div>
    </div>
  </body>

  <script>

    $(document).ready(function(){

        

        var count;
        var i=0;
        let correct=0;
        var jsonQuesAry;
        // alert("hii")
        // $("#myWindow").on("load", function(){
            // alert("hii")
            var subj=localStorage.getItem("subj");
        var diff=localStorage.getItem("diff");
         count=localStorage.getItem("count");
        // console.log(subj+" "+diff)
          jsonQuesAry=[];
            let obj={
                type:"get",
                url:"/create-ai-quiz",
                data:{
                    subj:subj,
                    diff:diff,
                    count:count

                }
            }
            $.ajax(obj).done(function(resp){
                jsonQuesAry=JSON.parse(resp)
                // console.log(resp);

                $("#spin").css("display","none")    // spinner off

                //  alert(resp);
                showQuestion();


                // alert(JSON.stringify(jsonQuesAry));
            }).fail(function(err){
                alert(err.statusText)
            })
        // });



    function showQuestion()
    {
    // console.log(i);
    // console.log(count);
       if(i<=count)
       {
        document.getElementById("numb").innerHTML=i+1;
        document.getElementById("count").innerHTML=count;
        document.getElementById("smlcnt").innerHTML=count;
        document.getElementById("smlnum").innerHTML=i+1;
       document.getElementById("question").innerHTML="Question."+(1+i)+"."+jsonQuesAry[i].question;
       document.getElementById("option1").value=jsonQuesAry[i].options[0];
       document.getElementById("soption1").innerHTML=jsonQuesAry[i].options[0];

       document.getElementById("option2").value=jsonQuesAry[i].options[1];

       document.getElementById("soption2").innerHTML=jsonQuesAry[i].options[1];


       document.getElementById("option3").value=jsonQuesAry[i].options[2];
       document.getElementById("soption3").innerHTML=jsonQuesAry[i].options[2];


       document.getElementById("option4").value=jsonQuesAry[i].options[3];
       document.getElementById("soption4").innerHTML=jsonQuesAry[i].options[3];
    }
       else
       alert("No More QUestions");



    }
    $('input[name="answer"]').click(function(){

        var selOpt=$('input[name="answer"]:checked').val();


        if(selOpt==jsonQuesAry[i].ans)
        {
            // alert(jsonQuesAry[i].ans)
            correct+=1
        }
        else{
            //alert("incorrect")
        }
    })

    $("#btnNext").click(function()
     {
        // alert(i);
         i=i+1

        if(i==jsonQuesAry.length)
        {
        $("#btnNext").css("display","none")
        // alert("Hide Next Button  and show Result Wala Button");
        // alert("Correct number of questions="+correct)
        return;
        }
    showQuestion();
     })

     $("#btnPrev").click(function(){
        i=i-1;
        showQuestion();
     })

    })
  </script>
</html>
